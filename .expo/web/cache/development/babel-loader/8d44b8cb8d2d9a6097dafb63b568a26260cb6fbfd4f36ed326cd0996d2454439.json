{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AuthProvider = exports.AuthContext = void 0;\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _asyncStorage = _interopRequireDefault(require(\"@react-native-async-storage/async-storage\"));\nvar _axios = _interopRequireDefault(require(\"axios\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _config = require(\"../config\");\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _this = this,\n  _jsxFileName = \"C:\\\\Users\\\\idriss.drame\\\\Projet\\\\ApmNews\\\\src\\\\context\\\\AuthContext.js\";\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nvar AuthContext = (0, _react.createContext)();\nexports.AuthContext = AuthContext;\nvar AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = (0, _react.useState)({}),\n    _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n    userInfo = _useState2[0],\n    setUserInfo = _useState2[1];\n  var _useState3 = (0, _react.useState)(false),\n    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n    isLoading = _useState4[0],\n    setIsLoading = _useState4[1];\n  var _useState5 = (0, _react.useState)(false),\n    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n    splashLoading = _useState6[0],\n    setSplashLoading = _useState6[1];\n  var loginA = function loginA(login, password) {\n    setIsLoading(true);\n    (0, _axios.default)({\n      method: 'post',\n      url: 'https://app.apmnews.com/1.0/auth.php',\n      params: {\n        login: login,\n        password: password\n      }\n    }).then(function (res) {\n      var userInfo = res.data;\n      console.log(userInfo.user_to);\n      setUserInfo(userInfo);\n      _asyncStorage.default.setItem('userInfo', JSON.stringify(userInfo));\n      setIsLoading(false);\n      alert(\"Bon déroulé\");\n    }).catch(function (e) {\n      console.log(\"login error \" + e);\n      setIsLoading(false);\n      alert(e);\n    });\n  };\n  var logout = function logout() {\n    setIsLoading(true);\n    console.log(\"test\");\n    _axios.default.post(\"https://app.apmnews.com/logout.php\", {}, {\n      headers: {\n        Authorization: \"Bearer \" + userInfo.user_token\n      }\n    }).then(function (res) {\n      console.log(res.data);\n      _asyncStorage.default.removeItem('userInfo');\n      setUserInfo({});\n      setIsLoading(false);\n    }).catch(function (e) {\n      console.log(\"logout error \" + e);\n      setIsLoading(false);\n    });\n  };\n  var isLoggedIn = function () {\n    var _ref2 = (0, _asyncToGenerator2.default)(function* () {\n      try {\n        setSplashLoading(true);\n        var _userInfo = yield _asyncStorage.default.getItem('userInfo');\n        _userInfo = JSON.parse(_userInfo);\n        if (_userInfo) {\n          setUserInfo(_userInfo);\n        }\n        setSplashLoading(false);\n      } catch (e) {\n        setSplashLoading(false);\n        console.log(\"is logged in error \" + e);\n      }\n    });\n    return function isLoggedIn() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  (0, _react.useEffect)(function () {\n    isLoggedIn();\n  }, []);\n  return (0, _jsxRuntime.jsx)(AuthContext.Provider, {\n    value: {\n      isLoading: isLoading,\n      userInfo: userInfo,\n      splashLoading: splashLoading,\n      loginA: loginA,\n      logout: logout\n    },\n    children: children\n  });\n};\nexports.AuthProvider = AuthProvider;","map":{"version":3,"names":["_asyncStorage","_interopRequireDefault","require","_axios","_react","_interopRequireWildcard","_config","_jsxRuntime","_this","_jsxFileName","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","AuthContext","createContext","exports","AuthProvider","_ref","children","_useState","useState","_useState2","_slicedToArray2","userInfo","setUserInfo","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","splashLoading","setSplashLoading","loginA","login","password","axios","method","url","params","then","res","data","console","log","user_to","AsyncStorage","setItem","JSON","stringify","alert","catch","e","logout","post","headers","Authorization","user_token","removeItem","isLoggedIn","_ref2","_asyncToGenerator2","getItem","parse","apply","arguments","useEffect","jsx","Provider","value"],"sources":["C:/Users/idriss.drame/Projet/ApmNews/src/context/AuthContext.js"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\nimport axios from 'axios';\nimport React, {createContext, useEffect, useState} from 'react';\n\nimport {BASE_URL} from '../config';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({children}) => {\n  const [userInfo, setUserInfo] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [splashLoading, setSplashLoading] = useState(false);\n\n\n\n  const loginA= (login, password) => {\n    setIsLoading(true);\n\n    axios({\n      method: 'post',\n      url: 'https://app.apmnews.com/1.0/auth.php',\n      params: {\n        login: login,\n        password: password\n      }\n    })  \n      \n      .then(res => {\n    \n\n        let userInfo = res.data;\n        console.log(userInfo.user_to);\n        setUserInfo(userInfo);\n        AsyncStorage.setItem('userInfo', JSON.stringify(userInfo));\n        setIsLoading(false);\n        alert (\"Bon déroulé\")\n      })\n      .catch(e => {\n     \n        console.log(`login error ${e}`);\n        setIsLoading(false);\n        alert (e)\n      });\n  };\n\n  const logout = () => {\n    setIsLoading(true);\nconsole.log(\"test\")\n    axios\n      .post(\n        `https://app.apmnews.com/logout.php`,\n        {},\n        {\n          headers: {Authorization: `Bearer ${userInfo.user_token}`},\n        },\n      )\n      .then(res => {\n        console.log(res.data);\n        AsyncStorage.removeItem('userInfo');\n        setUserInfo({});\n        setIsLoading(false);\n      })\n      .catch(e => {\n        console.log(`logout error ${e}`);\n        setIsLoading(false);\n      });\n  };\n\n  const isLoggedIn = async () => {\n    try {\n      setSplashLoading(true);\n\n      let userInfo = await AsyncStorage.getItem('userInfo');\n      userInfo = JSON.parse(userInfo);\n\n      if (userInfo) {\n        setUserInfo(userInfo);\n      }\n\n      setSplashLoading(false);\n    } catch (e) {\n      setSplashLoading(false);\n      console.log(`is logged in error ${e}`);\n    }\n  };\n\n  useEffect(() => {\n    isLoggedIn();\n  }, []);\n\n  return (\n    <AuthContext.Provider\n      value={{\n        isLoading,\n        userInfo,\n        splashLoading,\n\n        loginA,\n        logout,\n      }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}